# Product Vision - iOS Content Parser

## 1) 产品愿景
为 iOS 快捷指令用户提供“一键解析 → AI 增强 → 一键保存”的内容采集体验，覆盖小红书/B站/微信公众号等主流平台，自动输出适配 flomo / 备忘录 的结构化笔记与 URL Scheme，降低整理成本、提升记录质量与效率。

## 2) 目标用户
- iOS 重度用户与效率爱好者（大量使用快捷指令/自动化）
- 内容整理者与知识管理从业者（跨平台采集内容）
- 普通用户（偶尔保存灵感或实用信息到 flomo/备忘录）

## 3) 要解决的核心问题
- 跨平台内容抓取困难：链接样式多、反爬策略强、动态渲染多
- 手动整理成本高：复制粘贴、清洗排版、添加标签分类耗时
- 移动端保存不顺畅：从 App 到笔记应用存在较多步骤

## 4) 关键特性（与版本里程碑）
- v1.0 解析基础
	- 平台适配：小红书 / B站 / 公众号
	- 智能降级：ofetch → Playwright → 通用解析
	- iOS URL Scheme 输出：flomo、Notes
	- 缓存与错误处理：稳态可用
- v2.0 AI 增强（已上线）
	- 智能摘要、标题优化、内容分类、标签抽取
	- LangChain 集成，支持多模型（通义千问 Qwen Plus 优先，OpenAI 备选）
	- 成本控制：智能缓存、模型分层、日预算与单次限额
- v2.1 体验与观测（进行中）
	- 性能指标与错误监控、解析缓存、策略优化

## 5) 业务目标与指标（SMART）
- 准确率：平台内核心字段解析成功率 ≥ 95%
- 速度：标准解析 P95 < 3s；AI 增强 P95 < 5s；缓存命中 < 500ms
- 可靠性：核心 API 可用性 ≥ 99.9%
- 成本：AI 增强平均每次 < $0.01（以 Qwen Plus 为主）
- 采纳：每周活跃快捷指令调用数、flomo 跳转成功率、失败率下降趋势

## 6) 非功能性约束
- 隐私：不持久化用户内容，仅内存处理；严格的 URL 校验与 SSRF 防护
- 部署：Vercel Serverless，Playwright 在生产环境默认禁用、引导使用预取 HTML
- 兼容：Node 18+；iOS 快捷指令 URL Scheme 兼容 flomo/Notes

## 7) 范围边界（Out of Scope）
- 不提供付费墙穿透/账号登录等平台受限能力
- 不做通用爬虫与平台官方 API 集成（当前以直抓 HTML 为主）
- 不做长期内容存储与同步（由目标应用承担）

## 8) 集成策略
- flomo：一等输出（结构化、带分类与标签）
- iOS 备忘录：二等输出（轻量文本）
- URL Scheme：确保无需手动跳转即可落笔
- iOS Shortcuts：提供预设与步骤说明，推荐“预取 HTML”方案

## 9) 成功度量与验证
- 端到端：parse → ios_url 可用 → 目标 App 成功打开比例
- 质量：解析字段完整度（标题/正文/图片/作者/时间）
- AI：摘要可读性（用户评分）、标题优化点击率、分类/标签一致性
- 成本：单位请求 AI 花费、缓存命中率

## 10) 风险与对策
- 平台结构频繁变化：建立解析器热更新与回归用例
- 反爬导致失败：在生产建议“预取 HTML”；本地使用 Playwright 兜底
- AI 波动/费用：默认 Qwen Plus；失败自动回退；限额保护与缓存